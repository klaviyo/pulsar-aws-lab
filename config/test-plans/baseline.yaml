# Baseline Test Plan
# Series of tests to establish performance baseline

name: "baseline-performance"
description: "Baseline performance tests with varying loads and configurations"

# Base workload configuration (inherited by all test runs unless overridden)
base_workload:
  name: "baseline"
  topics: 1
  partitions_per_topic: 16
  message_size: 1024  # 1 KB messages
  subscriptions_per_topic: 1
  producers_per_topic: 1
  consumers_per_topic: 1
  consumer_backlog_size_gb: 0
  test_duration_minutes: 5
  warmup_duration_minutes: 1

# Test run variations
test_runs:
  # Test 1: Find maximum throughput
  - name: "max-throughput"
    description: "Determine maximum sustainable throughput"
    type: "max_rate"

  # Test 2: Fixed rate test at moderate load
  - name: "fixed-rate-10k"
    description: "Fixed rate at 10k msgs/sec"
    type: "fixed_rate"
    producer_rate: 10000

  # Test 3: Fixed rate test at higher load
  - name: "fixed-rate-50k"
    description: "Fixed rate at 50k msgs/sec"
    type: "fixed_rate"
    producer_rate: 50000

  # Test 4: Latency-focused test with low load
  - name: "latency-test"
    description: "Low load latency characterization"
    type: "latency_test"
    producer_rate: 1000

  # Test 5: Multiple topics
  - name: "multi-topic"
    description: "Multiple topics test"
    type: "fixed_rate"
    producer_rate: 25000
    workload_overrides:
      topics: 10
      partitions_per_topic: 4

  # Test 6: Larger messages
  - name: "large-messages"
    description: "64KB message test"
    type: "fixed_rate"
    producer_rate: 5000
    workload_overrides:
      message_size: 65536  # 64 KB

  # Test 7: Multiple producers/consumers
  - name: "multi-producer-consumer"
    description: "Multiple producers and consumers per topic"
    type: "fixed_rate"
    producer_rate: 50000
    workload_overrides:
      producers_per_topic: 4
      consumers_per_topic: 4

  # Test 8: Ramp up test
  - name: "ramp-up"
    description: "Gradual load increase"
    type: "ramp_up"
    ramp_up_steps:
      - rate: 10000
        duration_minutes: 2
      - rate: 25000
        duration_minutes: 2
      - rate: 50000
        duration_minutes: 2
      - rate: 75000
        duration_minutes: 2

  # Test 9: Scale to failure
  - name: "scale-to-failure"
    description: "Increase load until failure criteria met"
    type: "scale_to_failure"
    failure_criteria:
      max_latency_ms: 1000  # Fail if p99 latency > 1s
      max_error_rate_percent: 1.0  # Fail if error rate > 1%

# Reporting configuration
reporting:
  output_format:
    - "html"
    - "json"
    - "csv"
  include_raw_data: true
  metrics_to_highlight:
    - "throughput"
    - "p99_latency"
    - "cost_per_million_msgs"
